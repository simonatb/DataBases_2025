--- 1 ---
SELECT SHIP
FROM OUTCOMES
WHERE (SHIP LIKE 'C%' OR SHIP LIKE 'K%')
GROUP BY SHIP
HAVING COUNT(BATTLE) > 0

--- 2 ---
SELECT SHIPS.NAME,CLASSES.COUNTRY
FROM SHIPS JOIN CLASSES 
     ON CLASSES.CLASS = SHIPS.CLASS
     LEFT JOIN OUTCOMES ON OUTCOMES.SHIP = SHIPS.NAME
WHERE RESULT != 'sunk'  OR RESULT IS NULL

--- 3 ---
SELECT COUNTRY,COUNT(SHIP) AS SHIP_COUNT
FROM CLASSES LEFT JOIN SHIPS ON CLASSES.CLASS = SHIPS.CLASS
LEFT JOIN OUTCOMES ON OUTCOMES.SHIP = SHIPS.NAME
WHERE RESULT = 'sunk' or RESULT IS NULL
GROUP BY CLASSES.COUNTRY

--- 4 ---
SELECT BATTLE
FROM OUTCOMES
GROUP BY BATTLE
HAVING COUNT(SHIP) > (SELECT COUNT(SHIP) FROM OUTCOMES WHERE BATTLE = 'Guadalcanal')

--- 5 ---
SELECT BATTLE
FROM CLASSES JOIN SHIPS ON CLASSES.CLASS = SHIPS.CLASS
JOIN OUTCOMES ON OUTCOMES.SHIP = SHIPS.NAME
GROUP BY BATTLE
HAVING COUNT(COUNTRY) > (SELECT COUNT(COUNTRY) FROM CLASSES JOIN SHIPS 
                         ON CLASSES.CLASS = SHIPS.CLASS
                         JOIN OUTCOMES ON OUTCOMES.SHIP = SHIPS.NAME 
						 WHERE BATTLE = 'Surigao Strait')

--- 6 ---
SELECT NAME,DISPLACEMENT,NUMGUNS
FROM CLASSES JOIN SHIPS ON CLASSES.CLASS = SHIPS.CLASS
WHERE DISPLACEMENT = (SELECT TOP 1 DISPLACEMENT 
                      FROM CLASSES 
					  ORDER BY DISPLACEMENT ASC) 
AND NUMGUNS = (SELECT TOP 1 NUMGUNS 
                      FROM CLASSES 
					  WHERE DISPLACEMENT = (SELECT TOP 1 DISPLACEMENT 
                                            FROM CLASSES 
					                        ORDER BY DISPLACEMENT ASC)
					  ORDER BY NUMGUNS ASC)

--- 7 ---
SELECT COUNT(SHIP)
FROM BATTLES JOIN OUTCOMES AS O
ON O.BATTLE = BATTLES.NAME
GROUP BY O.SHIP,O.RESULT,BATTLES.DATE
HAVING O.RESULT = 'ok' AND BATTLES.DATE > (SELECT BATTLES.DATE
                          FROM BATTLES JOIN OUTCOMES 
                          ON OUTCOMES.BATTLE = BATTLES.NAME
						  WHERE O.SHIP = OUTCOMES.SHIP
						  GROUP BY OUTCOMES.SHIP, OUTCOMES.RESULT, BATTLES.DATE
				          HAVING OUTCOMES.RESULT = 'damaged')

--- 8 ---
SELECT SHIP
FROM BATTLES JOIN OUTCOMES AS O
ON O.BATTLE = BATTLES.NAME
GROUP BY O.SHIP,O.RESULT,BATTLES.DATE
HAVING O.RESULT = 'ok' AND BATTLES.DATE > (SELECT BATTLES.DATE
                          FROM BATTLES JOIN OUTCOMES 
                          ON OUTCOMES.BATTLE = BATTLES.NAME
						  WHERE O.SHIP = OUTCOMES.SHIP
						  GROUP BY OUTCOMES.SHIP, OUTCOMES.RESULT, BATTLES.DATE
				          HAVING OUTCOMES.RESULT = 'damaged')
						AND COUNT(O.SHIP) >= (SELECT COUNT(OUTCOMES.SHIP)
                         FROM OUTCOMES
                                  JOIN BATTLES
                                       ON OUTCOMES.BATTLE = BATTLES.NAME
                         WHERE OUTCOMES.SHIP = O.SHIP
                         GROUP BY OUTCOMES.BATTLE, OUTCOMES.RESULT, BATTLES.DATE
                         HAVING OUTCOMES.RESULT = 'damaged')
